<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head><script src="/site/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=site/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.147.0">

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">



<link rel="shortcut icon" href="/site/favicons/favicon.ico?v=1" >
<link rel="apple-touch-icon" href="/site/favicons/apple-touch-icon-180x180.png?v=1" sizes="180x180">
<link rel="icon" type="image/png" href="/site/favicons/favicon-16x16.png?v=1" sizes="16x16">
<link rel="icon" type="image/png" href="/site/favicons/favicon-32x32.png?v=1" sizes="32x32">
<link rel="apple-touch-icon" href="/site/favicons/apple-touch-icon-180x180.png?v=1" sizes="180x180">
<title>Model Tuning with VertexAI | Agones</title><meta property="og:url" content="http://localhost:1313/site/dsblog/dsblog/2023-07-24-6081-model-tuning-with-vertexai/">
  <meta property="og:site_name" content="Agones">
  <meta property="og:title" content="Model Tuning with VertexAI">
  <meta property="og:description" content="Tuning Large Language Model with VertexAI Why Model Tuning? Tuning is required when you want the model to learn something niche or specific that deviates from general language patterns.
Goal of Tuning Classification prompt: “Classify the following text into one of the following classes: [business, entertainment].”
Summarization prompt: “Summarize: Jessica: That sounds great! See you in Times Square! Alexander: See you at 10!”
response: “#Person1 and #Person2 agree to meet at Times Square at 10:00 AM.”">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="dsblog">
    <meta property="article:published_time" content="2023-07-24T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-07-24T00:00:00+00:00">
    <meta property="article:tag" content="Google Cloud">
    <meta property="article:tag" content="VertexAI">
    <meta property="article:tag" content="Machine Learning">
    <meta property="article:tag" content="Model Tuning">
    <meta property="article:tag" content="Cloud AI">
    <meta property="article:tag" content="MLOps">

  <meta itemprop="name" content="Model Tuning with VertexAI">
  <meta itemprop="description" content="Tuning Large Language Model with VertexAI Why Model Tuning? Tuning is required when you want the model to learn something niche or specific that deviates from general language patterns.
Goal of Tuning Classification prompt: “Classify the following text into one of the following classes: [business, entertainment].”
Summarization prompt: “Summarize: Jessica: That sounds great! See you in Times Square! Alexander: See you at 10!”
response: “#Person1 and #Person2 agree to meet at Times Square at 10:00 AM.”">
  <meta itemprop="datePublished" content="2023-07-24T00:00:00+00:00">
  <meta itemprop="dateModified" content="2023-07-24T00:00:00+00:00">
  <meta itemprop="wordCount" content="725">
  <meta itemprop="keywords" content="VertexAI,Google Cloud AI,Model Tuning,Machine Learning Platform,AI Model Optimization,Cloud ML,Model Training,Google AI">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Model Tuning with VertexAI">
  <meta name="twitter:description" content="Tuning Large Language Model with VertexAI Why Model Tuning? Tuning is required when you want the model to learn something niche or specific that deviates from general language patterns.
Goal of Tuning Classification prompt: “Classify the following text into one of the following classes: [business, entertainment].”
Summarization prompt: “Summarize: Jessica: That sounds great! See you in Times Square! Alexander: See you at 10!”
response: “#Person1 and #Person2 agree to meet at Times Square at 10:00 AM.”">



<link rel="stylesheet" href="/site/css/prism.css"/>

<link href="/site/scss/main.css" rel="stylesheet">

<link rel="stylesheet" type="text/css" href=http://localhost:1313/site/css/asciinema-player.css />
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-light  nav-shadow flex-column flex-md-row td-navbar">

	<a id="agones-top"  class="navbar-brand" href="/site/">
		<svg xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" viewBox="0 0 276 276" height="30" width="30" id="svg2"><defs id="defs6"><clipPath id="clipPath18" clipPathUnits="userSpaceOnUse"><path id="path16" d="M0 8e2H8e2V0H0z"/></clipPath></defs><g transform="matrix(1.3333333,0,0,-1.3333333,-398.3522,928.28029)" id="g10"><g transform="translate(2.5702576,82.614887)" id="g12"><circle transform="scale(1,-1)" r="102.69205" cy="-510.09534" cx="399.71484" id="path930" style="opacity:1;vector-effect:none;fill:#fff;fill-opacity:1;stroke:none;stroke-width:.65861601;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"/><g id="g40" transform="translate(239.9974,355.2515)"/><g transform="translate(4.931459e-6,39.355242)" id="g917"><g transform="translate(386.7049,451.9248)" id="g44"><path id="path46" style="fill:#2d70de;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m0 0c.087-2.62-1.634-4.953-4.163-5.646-7.609-2.083-14.615-5.497-21.089-10.181-5.102-3.691-10.224-7.371-15.52-10.769-3.718-2.385-7.711-4.257-12.438-3.601-6.255.868-10.629 4.828-12.313 11.575-.619 2.478-1.169 4.997-1.457 7.53-.47 4.135-.699 8.297-1.031 12.448.32 18.264 5.042 35.123 15.47 50.223 6.695 9.693 16.067 14.894 27.708 16.085 4.103.419 8.134.365 12.108-.059 3.313-.353 5.413-3.475 5.034-6.785-.039-.337-.059-.682-.059-1.033.0-.2.008-.396.021-.593-.03-1.164-.051-1.823-.487-3.253-.356-1.17-1.37-3.116-4.045-3.504h-10.267c-3.264.0-5.91-3.291-5.91-7.35.0-4.059 2.646-7.35 5.91-7.35H4.303C6.98 37.35 7.996 35.403 8.352 34.232 8.81 32.726 8.809 32.076 8.843 30.787 8.837 30.655 8.834 30.521 8.834 30.387c0-4.059 2.646-7.349 5.911-7.349h3.7c3.264.0 5.911-3.292 5.911-7.35.0-4.06-2.647-7.351-5.911-7.351H5.878c-3.264.0-5.911-3.291-5.911-7.35z"/></g><g transform="translate(467.9637,499.8276)" id="g48"><path id="path50" style="fill:#17252e;fill-opacity:1;fill-rule:nonzero;stroke:none" d="m0 0c-8.346 13.973-20.665 20.377-36.728 20.045-1.862-.038-3.708-.16-5.539-.356-1.637-.175-2.591-2.02-1.739-3.428.736-1.219 1.173-2.732 1.173-4.377.0-4.059-2.646-7.35-5.912-7.35h-17.733c-3.264.0-5.911-3.291-5.911-7.35.0-4.059 2.647-7.35 5.911-7.35h13.628c3.142.0 5.71-3.048 5.899-6.895l.013.015c.082-1.94-.032-2.51.52-4.321.354-1.165 1.359-3.095 4.001-3.498h14.69c3.265.0 5.911-3.292 5.911-7.35.0-4.06-2.646-7.351-5.911-7.351h-23.349c-2.838-.311-3.897-2.33-4.263-3.532-.434-1.426-.456-2.085-.485-3.246.011-.189.019-.379.019-.572.0-.341-.019-.677-.055-1.006-.281-2.535 1.584-4.771 4.057-5.396 8.245-2.084 15.933-5.839 23.112-11.209 5.216-3.901 10.678-7.497 16.219-10.922 2.152-1.331 4.782-2.351 7.279-2.578 8.033-.731 13.657 3.531 15.686 11.437 1.442 5.615 2.093 11.343 2.244 17.134C13.198-31.758 9.121-15.269.0.0"/></g></g></g></g></svg> <span class="text-uppercase fw-bold">Agones</span>
	</a>

	<div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/site/docs/"><span>Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/site/blog/"><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/site/community/"><span>Community</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				<a class="nav-link" href="https://github.com/googleforgames/agones">GitHub</a>
			</li>
			<li class="nav-item dropdown d-none d-lg-block">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					Release
				</a>
				<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
					<a class="dropdown-item" href="https://development.agones.dev">Development</a>
					<a class="dropdown-item" href="https://agones.dev">1.48.0</a>
					<a class="dropdown-item" href="https://1-47-0.agones.dev">1.47.0</a>
					<a class="dropdown-item" href="https://1-46-0.agones.dev">1.46.0</a>
					<a class="dropdown-item" href="https://1-45-0.agones.dev">1.45.0</a>
					<a class="dropdown-item" href="https://1-44-0.agones.dev">1.44.0</a>
					<a class="dropdown-item" href="https://1-43-0.agones.dev">1.43.0</a>
					<a class="dropdown-item" href="https://1-42-0.agones.dev">1.42.0</a>
					<a class="dropdown-item" href="https://1-41-0.agones.dev">1.41.0</a>
					<a class="dropdown-item" href="https://1-40-0.agones.dev">1.40.0</a>
					<a class="dropdown-item" href="https://1-39-0.agones.dev">1.39.0</a>
					<a class="dropdown-item" href="https://1-38-0.agones.dev">1.38.0</a>
					<a class="dropdown-item" href="https://1-37-0.agones.dev">1.37.0</a>
					<a class="dropdown-item" href="https://1-36-0.agones.dev">1.36.0</a>
					<a class="dropdown-item" href="https://1-35-0.agones.dev">1.35.0</a>
					<a class="dropdown-item" href="https://1-34-0.agones.dev">1.34.0</a>
					<a class="dropdown-item" href="https://1-33-0.agones.dev">1.33.0</a>
					<a class="dropdown-item" href="https://1-32-0.agones.dev">1.32.0</a>
					<a class="dropdown-item" href="https://1-31-0.agones.dev">1.31.0</a>
				</div>
			</li>
			
		</ul>
	</div>
	<div class="navbar-nav mx-lg-2 d-none d-lg-block"><div class="td-search">
  <div class="td-search__icon"></div>
  <input id="agones-search" type="search" class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete="off">
</div></div>
</nav>

    </header>
    <div class="container-fluid td-default td-outer">
      <main role="main" class="td-main">
        <p><img src="/assets/images/dspost/dsp6081-Model-Tuning-with-VertexAI.jpg" alt="Model Tuning with VertexAI"></p>
<h1 id="tuning-large-language-model-with-vertexai">Tuning Large Language Model with VertexAI</h1>
<h2 id="why-model-tuning">Why Model Tuning?</h2>
<p>Tuning is required when you want the model to learn something niche or specific that deviates from general language patterns.</p>
<h2 id="goal-of-tuning">Goal of Tuning</h2>
<h3 id="classification">Classification</h3>
<p>prompt: &ldquo;Classify the following text into one of the following classes: [business, entertainment].&rdquo;</p>
<h3 id="summarization">Summarization</h3>
<p>prompt: &ldquo;Summarize: Jessica: That sounds great! See you in Times Square! Alexander: See you at 10!&rdquo;</p>
<p>response: &ldquo;#Person1 and #Person2 agree to meet at Times Square at 10:00 AM.&rdquo;</p>
<h3 id="extract-qa">Extract QA</h3>
<p>prompt: &ldquo;Context: There is evidence that there have been significant changes in Amazon rainforest vegetation over the last 21,000 years through the Last Glacial Maximum (LGM) and subsequent deglaciation. Question: What does LGM stand for?&rdquo;</p>
<p>response: &ldquo;Last Glacial Maximum&rdquo;</p>
<h2 id="prepare-your-model-tuning-dataset">Prepare your model tuning dataset</h2>
<h3 id="recommended-configurations">Recommended configurations</h3>
<p>The following table shows the recommended configurations for tuning a foundation model by task:</p>
<table>
  <thead>
      <tr>
          <th>Task</th>
          <th>No. of examples in dataset</th>
          <th>Train steps</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Classification</td>
          <td>100+</td>
          <td>100-500</td>
      </tr>
      <tr>
          <td>Summarization</td>
          <td>100-500+</td>
          <td>200-1000</td>
      </tr>
      <tr>
          <td>Extractive QA</td>
          <td>100+</td>
          <td>100-500</td>
      </tr>
  </tbody>
</table>
<p>For train steps, you can try more than one value to get the best performance on a particular dataset, for example, 100, 200, 500.</p>
<h3 id="dataset-format">Dataset format</h3>
<p>You can create your own dataset for training. Your dataset must be in JSON Lines (JSONL) format where each line contains a single training example. Content of JSONL file will be like below.</p>
<p>{&ldquo;input_text&rdquo;: &ldquo;question: How many copies of Gears of War 3 were sold ? context: Like its predecessors , the game received widespread critical acclaim from critics . Critics praised its story , voice acting , graphics and visuals , and music , but criticized its lack of innovation . Gears of War 3 sold over 3 million copies and was the second best selling game in the U . S . &ldquo;, &ldquo;output_text&rdquo;: &ldquo;over 3 million copies&rdquo;}
{&ldquo;input_text&rdquo;: &ldquo;question: How many parishes are there in Louisiana ? context: The U . S . state of Louisiana is divided into 64 parishes ( French : paroisses ) in the same manner that 48 other states of the United States are divided into counties , and Alaska is divided into boroughs . &ldquo;, &ldquo;output_text&rdquo;: &ldquo;64&rdquo;}</p>
<h3 id="creating-dataset">Creating Dataset</h3>
<p>Prepare model tuning dataset (train dataset)
Maintain consistency with test and production data (same format).</p>
<p>For example, if the examples in your dataset includes a &ldquo;question:&rdquo; and a &ldquo;context:&rdquo;, production traffic should also be formatted to include a &ldquo;question:&rdquo; and a &ldquo;context:&rdquo; in the same order as it appears in the dataset examples. If you exclude the context, the model will be confused as to what you are asking, even if the exact question was in an example in the dataset.</p>
<p>Include instructions in examples.<br>
Classify the following text into one of the following classes: [business, entertainment] Text: 5 stocks to buy now</p>
<h3 id="upload-tuning-dataset-to-cloud-storage-optional">Upload tuning dataset to Cloud Storage (Optional)</h3>
<p>For the demo use following example. Otherwise bring your dataset in the format below.
cloud-samples-data/ai-platform/generative_ai/headline_classification.jsonl</p>
<h3 id="tuning-with-vertexai">Tuning with VertexAI</h3>
<ul>
<li>VertexAI -&gt; Language -&gt; Create Tune Model</li>
<li>Select the tuning dataset (either from google cloud storage or cloud-samples-data/ai-platform/generative_ai/headline_classification.jsonl)
<ul>
<li>The above dataset contains 25 categorical question answering examples. If you use the sample dataset, the training will take 1-2 hours.</li>
</ul>
</li>
<li>Configure the model details &amp; Tune
<ul>
<li>Model name: Enter a name for your tuned model.</li>
<li>Base model: Select the foundation model that you want to tune.</li>
<li>Train steps: Enter the number of steps to run for model tuning. 1000 steps will take 2-3 hours to complete tuning.</li>
<li>Learning rate: Control the step size at which a model updates its weights during training. Default: 3.</li>
<li>Working directory: Enter the URI of the bucket to store the tuned model. If don&rsquo;t have one, you can create a new bucket.</li>
</ul>
</li>
</ul>
<h3 id="after-tuning">After tuning</h3>
<ul>
<li>To check the status of your model tuning job, go to the Pipelines page. The status of your pipeline can be found in the Runs section.</li>
<li>To view your tuned models in the Google Cloud console, go to the Vertex AI Model Registry page.</li>
</ul>
<h3 id="use-the-tuned-model">Use the tuned model</h3>
<ul>
<li>To use your tuned models with new prompts, go to the Language page.</li>
<li>Click Text prompt.</li>
<li>In the Model drop down, select the tuned model that you have created.</li>
<li>Copy the sample prompt and submit to view the results.</li>
</ul>
<pre tabindex="0"><code>Multi-choice problem: What is the topic of this text?
- business
- entertainment
- health
- sports
- technology
- politics
Text: What is a large language model (LLM)?
The answer is:
</code></pre>
      </main>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Slack" aria-label="Slack">
    <a target="_blank" rel="noopener" href="https://join.slack.com/t/agones/shared_invite/zt-2mg1j7ddw-0QYA9IAvFFRKw51ZBK6mkQ" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="User mailing list" aria-label="User mailing list">
    <a target="_blank" rel="noopener" href="https://groups.google.com/forum/#!forum/agones-discuss" aria-label="User mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/agonesdev" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Community Meetings" aria-label="Community Meetings">
    <a target="_blank" rel="noopener" href="https://www.youtube.com/playlist?list=PLhkWKwFGACw2dFpdmwxOyUCzlGP2-n7uF" aria-label="Community Meetings">
      <i class="fab fa-youtube"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/googleforgames/agones" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Slack" aria-label="Slack">
    <a target="_blank" rel="noopener" href="https://join.slack.com/t/agones/shared_invite/zt-2mg1j7ddw-0QYA9IAvFFRKw51ZBK6mkQ" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Community Meetings" aria-label="Community Meetings">
    <a target="_blank" rel="noopener" href="https://www.youtube.com/playlist?list=PLhkWKwFGACw2dFpdmwxOyUCzlGP2-n7uF" aria-label="Community Meetings">
      <i class="fab fa-youtube"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2025
    <span class="td-footer__authors">Copyright Google LLC All Rights Reserved.</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/site/js/main.js"></script>
<script src='/site/js/prism.js'></script>
<script src='/site/js/tabpane-persist.js'></script>
<script src=http://localhost:1313/site/js/asciinema-player.js></script>


<script > 
    (function() {
      var a = document.querySelector("#td-section-nav");
      addEventListener("beforeunload", function(b) {
          localStorage.setItem("menu.scrollTop", a.scrollTop)
      }), a.scrollTop = localStorage.getItem("menu.scrollTop")
    })()
  </script>
  

  </body>
</html>